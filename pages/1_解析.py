# -*- coding: utf-8 -*-
# pages/2_ãƒã‚¤ã‚¢ã‚¹è§£æ.py
import streamlit as st
import random
import datetime
from logic_simple import analyze_selection, render_finding_card

 
# =========================
# ãƒšãƒ¼ã‚¸å›ºæœ‰ã®ã‚­ãƒ¼ï¼ˆè¡çªé˜²æ­¢ï¼‰
# =========================
KEY_PREFIX = "p2_"
def k(name: str) -> str:
    return KEY_PREFIX + name

# =========================
# ãƒ¢ãƒã‚¤ãƒ«æœ€é©CSSï¼ˆèª­ã¿ã‚„ã™ã„æ–‡å­—ï¼‰
# =========================
st.markdown("""
<style>
.block-container{max-width:720px;margin:auto;}
h1{font-size:1.6rem !important;margin:1.8rem 0 1rem 0;}   /* â†ã‚¿ã‚¤ãƒˆãƒ«ã‚’å°‘ã—å¤§ãã */
h2, .stSubheader{font-size:1.1rem !important;}            /* â†ã‚µãƒ–è¦‹å‡ºã—ã‚’å°‘ã—å°ã•ã */
p, .stMarkdown{font-size:.95rem;line-height:1.6;}         
.small{color:#667085;font-size:.88rem;}
.stButton>button{font-size:.95rem;padding:.35rem 1rem;}
@media(max-width:480px){
    h1{font-size:1.4rem !important;}   /* ãƒ¢ãƒã‚¤ãƒ«ã§ã¯å°‘ã—æŠ‘ãˆã‚‹ */
    h2, .stSubheader{font-size:1.0rem !important;}
    p, .stMarkdown{font-size:.92rem;}
}
</style>
""", unsafe_allow_html=True)


# =========================
# ãƒ˜ãƒƒãƒ€ãƒ¼
# =========================
st.markdown("# ğŸ§  ãƒã‚¤ã‚¢ã‚¹è§£æï¼ˆã‹ã‚“ãŸã‚“ç‰ˆï¼‰")
st.caption("ã€Œâ€œæ€è€ƒã®ãƒã‚°â€ã‚’è¦‹ã¤ã‘ã¦ã€è„³ã®ä½¿ã„æ–¹ã‚’ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ")

# =========================
# 3æ®µéš ã‹ã‚“ãŸã‚“å…¥åŠ›
# =========================
st.subheader("1) ã‹ã‚“ãŸã‚“å…¥åŠ›ï¼ˆ3ã‚¹ãƒ†ãƒƒãƒ—ï¼‰")

# STEP1: ãƒ†ãƒ¼ãƒï¼ˆã‚·ãƒ¼ãƒ³ï¼‰
THEMES = ["ãŠé‡‘", "å­¦ã³", "äººé–“é–¢ä¿‚", "è²·ã„ç‰©", "ä»•äº‹ãƒ»ãƒã‚¤ãƒˆ"]
theme = st.radio("A. ã©ã®ãƒ†ãƒ¼ãƒï¼Ÿ", THEMES, key=k("theme"))

# STEP2: çŠ¶æ³ï¼ˆç›®çš„ï¼‰
SITUATIONS = {
    "ãŠé‡‘": ["è²¯é‡‘ã—ãŸã„", "å‡ºè²»ã‚’æ¸›ã‚‰ã—ãŸã„", "æŠ•è³‡ãŒæ°—ã«ãªã‚‹"],
    "å­¦ã³": ["å‹‰å¼·ãŒç¶šã‹ãªã„", "è³‡æ ¼ã‚’å–ã‚ŠãŸã„", "éƒ¨æ´»ãƒ»å‹‰å¼·ã®ä¸¡ç«‹"],
    "äººé–“é–¢ä¿‚": ["LINEã®æ—¢èª­ãŒæ°—ã«ãªã‚‹", "æ–­ã‚Œãªãã¦å›°ã‚‹", "å‹ã ã¡ã«æ„è¦‹ãŒè¨€ãˆãªã„"],
    "è²·ã„ç‰©": ["é«˜ã„ç‰©ã‚’è²·ã†ã‹è¿·ã†", "ã‚»ãƒ¼ãƒ«ã§è¡å‹•è²·ã„", "ã‚µãƒ–ã‚¹ã‚¯ã®ç¶™ç¶š"],
    "ä»•äº‹ãƒ»ãƒã‚¤ãƒˆ": ["ã‚·ãƒ•ãƒˆã‚’å¢—ã‚„ã™ã‹è¿·ã†", "æ–°ã—ã„ã“ã¨ã«æŒ‘æˆ¦", "ä¸Šæ‰‹ãé ¼ã‚Œãªã„"],
}
situation = st.selectbox("B. å…·ä½“çš„ãªçŠ¶æ³ã¯ï¼Ÿ", SITUATIONS[theme], key=k("situation"))

# STEP3: å¿ƒã®ã‚µã‚¤ãƒ³
SIGNS = ["æ™‚é–“ãŒãªã„æ°—ãŒã™ã‚‹", "æã™ã‚‹ã®ãŒæ€–ã„", "ã¿ã‚“ãªãŒã‚„ã£ã¦ã‚‹ã‹ã‚‰", "ãªã‚“ã¨ãªãä¸å®‰", "é¢å€’ã§å…ˆã®ã°ã—"]
sign = st.selectbox("C. ä»Šã®æ°—æŒã¡ã«è¿‘ã„ã‚‚ã®ã¯ï¼Ÿ", SIGNS, key=k("sign"))

st.markdown('<span class="small">ãƒ’ãƒ³ãƒˆï¼šAâ†’Bâ†’Cã‚’é¸ã¶ã¨â€œä»Šã®è‡ªåˆ†ã®æ€è€ƒã®ã‚¯ã‚»â€ãŒæµ®ãã‚„ã™ããªã‚Šã¾ã™ã€‚</span>', unsafe_allow_html=True)

# æ–‡ç« ï¼ˆä»»æ„ã€‚ãªãã¦ã‚‚OKï¼‰
st.subheader("2) ä¸€è¨€ãƒ¡ãƒ¢ï¼ˆä»»æ„ï¼‰")
user_text = st.text_area("ä»Šã®æ°—æŒã¡ã‚„çŠ¶æ³ã‚’1ã€œ3è¡Œã§ã€‚ç©ºã§ã‚‚OKã€‚", key=k("memo"), placeholder="ä¾‹ï¼‰ã‚»ãƒ¼ãƒ«ã§å®‰ã„ã¨èãã¨è²·ã‚ãªãã‚ƒæãªæ°—ãŒã—ã¦ç„¦ã‚‹ã€‚")

# =================
# è§£æãƒœã‚¿ãƒ³
# =================
if st.button("è§£æã™ã‚‹", type="primary", key=k("analyze_btn")):
    # ç°¡å˜è§£æãƒ­ã‚¸ãƒƒã‚¯ã‚’å‘¼ã¶
    findings = analyze_selection(theme, situation, sign, user_text)

    # çµæœã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä¿å­˜ï¼ˆNoneé˜²æ­¢ï¼‰
    st.session_state[k("findings")] = findings or []

    st.success("è§£æã—ã¾ã—ãŸã€‚ä¸‹ã®çµæœã‚’ã”ç¢ºèªãã ã•ã„ã€‚")


# =========================
# è§£æçµæœã®è¡¨ç¤º
# =========================
st.subheader("3) è§£æçµæœ")
findings = st.session_state.get(k("findings"), None)

if findings is None:
    st.caption("ï¼ˆã¾ã è§£æã—ã¦ã„ã¾ã›ã‚“ï¼‰")
elif len(findings) == 0:
    st.success("ä»Šå›ã¯åã‚Šã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚è½ã¡ç€ã„ã¦è€ƒãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚")
    st.info("å‹ã ã¡ã«â€œã©ã†è€ƒãˆãŸã‹â€ã‚’èª¬æ˜ã—ã¦ã¿ã‚‹ã¨ã€ã•ã‚‰ã«åˆ¤æ–­ãŒå¼·ããªã‚Šã¾ã™ã€‚")
else:
    st.caption("â€» â€œç¢ºã‹ã‚‰ã—ã•â€ã¯A/B/Cã®3æ®µéšï¼ˆA:é«˜ã„ï½œB:ä¸­ãã‚‰ã„ï½œC:ä½ã‚ï¼‰")
    for f in findings:
        render_finding_card(f)

# =========================
# å‹ã ã¡ã«è©±ã—ãŸããªã‚‹å°ãƒã‚¿ï¼ˆ1ã¤ã ã‘è¡¨ç¤ºï¼‰
# =========================


# æ—¥æ›¿ã‚ã‚Šã§å¤‰ã‚ã‚‹ã‚ˆã†ã«ã‚·ãƒ¼ãƒ‰è¨­å®šï¼ˆåŒã˜æ—¥ã¯å›ºå®šï¼‰
random.seed(datetime.date.today().isoformat())

TIPS = [
    {"title": "ãƒ•ãƒ¬ãƒ¼ãƒŸãƒ³ã‚°åŠ¹æœ",
     "desc": "åŒã˜å†…å®¹ã§ã‚‚è¨€ã„æ–¹ã§å°è±¡ãŒå¤‰ã‚ã‚‹ç¾è±¡ã€‚ãƒã‚¸ãƒ†ã‚£ãƒ–è¡¨ç¾ã¯è‰¯ãã€ãƒã‚¬ãƒ†ã‚£ãƒ–è¡¨ç¾ã¯æ‚ªãè¦‹ãˆã‚„ã™ã„ã€‚æ•°å€¤ã‚„äº‹å®Ÿã¯åŒã˜ã§ã‚‚åˆ¤æ–­ã¯æºã‚Œã¾ã™ã€‚",
     "examples": ["ã€ŒæˆåŠŸç‡90%ã€ã¨è¨€ã‚ã‚Œã‚‹ã¨æŒ‘æˆ¦ã—ãŸããªã‚‹", "ã€Œå¤±æ•—ç‡10%ã€ã ã¨åŒã˜å†…å®¹ã§ã‚‚é¿ã‘ãŒã¡"]},

    {"title": "ã‚¢ãƒ³ã‚«ãƒªãƒ³ã‚°",
     "desc": "æœ€åˆã«è¦‹ãŸæ•°å­—ãŒå¿ƒã®åŸºæº–ï¼ˆã‚¢ãƒ³ã‚«ãƒ¼ï¼‰ã«ãªã‚Šã€ãã®å¾Œã®åˆ¤æ–­ã«å¼·ãå½±éŸ¿ã™ã‚‹ã€‚æ ¹æ‹ ãŒå¼±ã„æ•°å­—ã§ã‚‚ç„¡æ„è­˜ã«å¼•ããšã‚‰ã‚Œã¾ã™ã€‚",
     "examples": ["æœ€åˆã«æç¤ºã•ã‚ŒãŸå®šä¾¡ãŒé«˜ãã€å€¤å¼•ãå¾ŒãŒå®‰ãæ„Ÿã˜ã‚‹", "æœ€åˆã®è¦‹ç©ã‚‚ã‚Šã‚’åŸºæº–ã«ã€è¿½åŠ è²»ç”¨ã‚’å¦¥å½“ã«æ„Ÿã˜ã‚‹"]},

    {"title": "ç¾çŠ¶ç¶­æŒãƒã‚¤ã‚¢ã‚¹",
     "desc": "å¤‰ãˆã‚‹ã“ã¨ã®ä¸å®‰ã‚„æ‰‹é–“ã‚’éå¤§ã«è¦‹ç©ã‚‚ã‚Šã€ä»Šã®çŠ¶æ…‹ã‚’é¸ã³ã‚„ã™ã„å‚¾å‘ã€‚å¤‰åŒ–ãã®ã‚‚ã®ã‚’â€œæâ€ã¨æ„Ÿã˜ã€åˆ¤æ–­ã‚’å…ˆå»¶ã°ã—ã«ã—ã¾ã™ã€‚",
     "examples": ["æ–™é‡‘ãƒ—ãƒ©ãƒ³ã‚’è¦‹ç›´ã•ãšã€é•·å¹´ãã®ã¾ã¾", "ä¸æº€ãŒã‚ã£ã¦ã‚‚ä»•äº‹ã‚„ç’°å¢ƒã‚’å¤‰ãˆãªã„"]},

    {"title": "ãƒãƒ­ãƒ¼åŠ¹æœ",
     "desc": "ç›®ç«‹ã¤é•·æ‰€ãƒ»çŸ­æ‰€ãŒå…¨ä½“è©•ä¾¡ã«åºƒãŒã‚‹ç¾è±¡ã€‚è¦‹ãŸç›®ã‚„è‚©æ›¸ã®å°è±¡ãŒã€ä¸­èº«ã®è©•ä¾¡ã«ã¾ã§å½±éŸ¿ã—ã¦ã—ã¾ã†â€œæ€ã„è¾¼ã¿ã®é€£é–â€ã§ã™ã€‚",
     "examples": ["æœ‰åä¼æ¥­å‡ºèº«ã¨ã„ã†ã ã‘ã§å„ªç§€ã ã¨æ€ã†", "æœè£…ãŒæ•´ã£ã¦ã„ã‚‹äººã‚’æœ‰èƒ½ã¨æ„Ÿã˜ã‚‹"]},

    {"title": "ç¢ºè¨¼ãƒã‚¤ã‚¢ã‚¹",
     "desc": "è‡ªåˆ†ã®ä¿¡ã˜ãŸã„çµè«–ã«åˆã†æƒ…å ±ã ã‘ã‚’é›†ã‚ã€åå¯¾ã®è¨¼æ‹ ã‚’è»½è¦–ã™ã‚‹å‚¾å‘ã€‚æ¤œç´¢ã®ä»•æ–¹ã‚„äººã®æ„è¦‹ã®èãæ–¹ã«ã‚‚è¡¨ã‚Œã¾ã™ã€‚",
     "examples": ["æ¨ã—ã®è‰¯ã„è©•åˆ¤ã ã‘ã‚’è¿½ã†", "è‡ªåˆ†ã®è€ƒãˆã«åã™ã‚‹è¨˜äº‹ã‚’ã™ãé–‰ã˜ã‚‹"]},

    {"title": "æå¤±å›é¿ãƒã‚¤ã‚¢ã‚¹",
     "desc": "åŒã˜é¡ã§ã‚‚å¾—ã‚ˆã‚Šæã‚’å¼·ãæ„Ÿã˜ã‚‹å¿ƒç†ã€‚æã‚’é¿ã‘ãŸã„æ°—æŒã¡ãŒã€å¿…è¦ä»¥ä¸Šã«ä¿å®ˆçš„ãªé¸æŠã‚„â€œæ‰‹æ”¾ã›ãªã„â€çŠ¶æ…‹ã‚’ç”Ÿã¿ã¾ã™ã€‚",
     "examples": ["å«ã¿æã®æ ªã‚’å£²ã‚Œãªã„", "è¿”å“ç„¡æ–™ã§ã‚‚å¤±ã£ãŸæ°—ãŒã—ã¦è¿”ã›ãªã„"]},

    {"title": "ä»£è¡¨æ€§ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯",
     "desc": "å°‘ãªã„äº‹ä¾‹ã‚„â€œãã‚Œã£ã½ã•â€ã§å…¨ä½“ã‚’åˆ¤æ–­ã—ã¦ã—ã¾ã†è¿‘é“æ€è€ƒã€‚çµ±è¨ˆã‚„æ¯æ•°ã‚’ç„¡è¦–ã—ã€å°è±¡çš„ãªäº‹ä¾‹ã«å¼•ã£å¼µã‚‰ã‚Œã¾ã™ã€‚",
     "examples": ["å£ã‚³ãƒŸæ•°ã‚ˆã‚Šå°è±¡çš„ãª1ä»¶ã«å·¦å³ã•ã‚Œã‚‹", "å…¸å‹çš„ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã«åˆã†äººã‚’è·æ¥­ã§æ±ºã‚ã¤ã‘ã‚‹"]},

    {"title": "é¸æŠã®ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹",
     "desc": "é¸æŠè‚¢ãŒå¤šã„ã»ã©è‰¯ã•ãã†ã«è¦‹ãˆã¦ã€å®Ÿéš›ã¯è¿·ã„ã¨å¾Œæ‚”ãŒå¢—ãˆã‚‹ç¾è±¡ã€‚æ±ºã‚ã‚‹è² è·ãŒé«˜ã¾ã‚Šæº€è¶³æ„Ÿã‚‚ä¸‹ãŒã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚",
     "examples": ["ã‚µãƒ–ã‚¹ã‚¯ã®ãƒ—ãƒ©ãƒ³ãŒå¤šã™ãã¦æ±ºã‚ã‚‰ã‚Œãªã„", "è²·ã£ãŸå¾Œã«ä»–ã®é¸æŠè‚¢ã‚’è¦‹ã¦å¾Œæ‚”"]},

    {"title": "è¨ˆç”»éŒ¯èª¤",
     "desc": "ä½œæ¥­æ™‚é–“ã‚„ã‚³ã‚¹ãƒˆã‚’æ¥½è¦³çš„ã«è¦‹ç©ã‚‚ã‚‹å‚¾å‘ã€‚éå»ã®çµŒé¨“ã‚’ååˆ†ã«åæ˜ ã§ããšã€â€œä»Šå›ã¯ã†ã¾ãè¡Œãâ€ã¨æ€ã„ãŒã¡ã§ã™ã€‚",
     "examples": ["èª²é¡Œã‚’å‰æ—¥ã§çµ‚ã‚ã‚‹ã¨è¦‹ç©ã‚‚ã‚‹", "å¼•ã£è¶Šã—æº–å‚™ãŒæƒ³å®šã‚ˆã‚Šå¤§å¹…ã«é…ã‚Œã‚‹"]},

    {"title": "ç¤¾ä¼šçš„è¨¼æ˜",
     "desc": "å¤šãã®äººãŒã—ã¦ã„ã‚‹ã“ã¨ã‚’æ­£ã—ã„ã¨æ„Ÿã˜ã‚‹å¿ƒç†ã€‚ä»–è€…ã®è¡Œå‹•ãŒâ€œå®‰å…¨ãƒ»å¦¥å½“â€ã®ã‚µã‚¤ãƒ³ã¨ãªã‚Šã€åˆ¤æ–­ã‚’çœåŠ›åŒ–ã—ã¾ã™ã€‚",
     "examples": ["è¡Œåˆ—ã®ã‚ã‚‹åº—ã«å®‰å¿ƒã—ã¦å…¥ã‚‹", "å†ç”Ÿæ•°ãŒå¤šã„å‹•ç”»ã‚’ã¾ãšè¦‹ã‚‹"]},

    {"title": "ä¿æœ‰åŠ¹æœ",
     "desc": "è‡ªåˆ†ãŒæŒã£ã¦ã„ã‚‹ã ã‘ã§ä¾¡å€¤ã‚’é«˜ãè¦‹ç©ã‚‚ã‚‹å‚¾å‘ã€‚æ‰‹æ”¾ã™ç—›ã¿ãŒå¢—å¹…ã•ã‚Œã€â€œåŒã˜ã‚‚ã®ã§ã‚‚æ‰€æœ‰å¾Œã¯é«˜ãæ„Ÿã˜ã‚‹â€ç¾è±¡ã§ã™ã€‚",
     "examples": ["ä½¿ã‚ãªã„ã®ã«ãƒ•ãƒªãƒã§é«˜é¡å‡ºå“ã«ã—ãŒã¡", "æ™¯å“ã§ã‚‚æ¨ã¦ã¥ã‚‰ã„"]},

    {"title": "ã‚µãƒ³ã‚¯ã‚³ã‚¹ãƒˆåŠ¹æœ",
     "desc": "å›åä¸èƒ½ã®ã‚³ã‚¹ãƒˆã«ç¸›ã‚‰ã‚Œã¦ã‚„ã‚ã‚‰ã‚Œãªããªã‚‹ç¾è±¡ã€‚â€œã‚‚ã£ãŸã„ãªã„â€ãŒåˆ¤æ–­ã‚’æ›‡ã‚‰ã›ã€åˆç†çš„ãªæ’¤é€€ã‚’é…ã‚‰ã›ã¾ã™ã€‚",
     "examples": ["ã¤ã¾ã‚‰ãªã„æ˜ ç”»ã‚’æœ€å¾Œã¾ã§è¦‹ã‚‹", "åˆã‚ãªã„ç¿’ã„äº‹ã‚’ä¼šè²»ãŒæƒœã—ãã¦ç¶šã‘ã‚‹"]},

    {"title": "ãƒ—ãƒ­ã‚¹ãƒšã‚¯ãƒˆç†è«–",
     "desc": "äººã¯åˆ©ç›Šã§ã¯ãƒªã‚¹ã‚¯å›é¿ã€æå¤±ã§ã¯ãƒªã‚¹ã‚¯é¸å¥½ã«ãªã‚Šã‚„ã™ã„ã¨ã„ã†æ³•å‰‡ã€‚æã‚’å–ã‚Šè¿”ãã†ã¨ã—ã¦ç„¡ç†ã‚’é‡ã­ã¦ã—ã¾ã„ã¾ã™ã€‚",
     "examples": ["è² ã‘ã‚’å–ã‚Šè¿”ãã†ã¨ãƒ™ãƒƒãƒˆé¡ã‚’ä¸Šã’ã‚‹", "å€¤ä¸ŠãŒã‚Šç›Šã¯ã™ãç¢ºå®šã—ãŒã¡"]},

    {"title": "æ¥½è¦³ãƒã‚¤ã‚¢ã‚¹",
     "desc": "è‡ªåˆ†ã ã‘ã¯å¤§ä¸ˆå¤«ã¨è¦‹ç©ã‚‚ã‚ŠãŒã¡ã€‚ãƒªã‚¹ã‚¯ç®¡ç†ã‚„å‚™ãˆãŒå¾Œå›ã—ã«ãªã‚Šã€ã„ã–ã¨ã„ã†æ™‚ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ãŒå¤§ãããªã‚Šã¾ã™ã€‚",
     "examples": ["ç½å®³ã®å‚™è“„ã‚’å…ˆå»¶ã°ã—", "ç· åˆ‡ç›´å‰ã§ã‚‚é–“ã«åˆã†ã¨è€ƒãˆã‚‹"]},

    {"title": "æ¨©å¨ãƒã‚¤ã‚¢ã‚¹",
     "desc": "å°‚é–€å®¶ã‚„æœ‰åäººã®æ„è¦‹ã ã¨ã€æ ¹æ‹ ã‚’ç²¾æŸ»ã›ãšä¿¡ã˜ã‚„ã™ã„å¿ƒç†ã€‚è‚©æ›¸ã‚„ç«‹å ´ãŒâ€œè³ªã®ä¿è¨¼â€ã«è¦‹ãˆã¦ã—ã¾ã„ã¾ã™ã€‚",
     "examples": ["æœ‰åäººã®ãŠã™ã™ã‚ã‚’ç„¡æ¡ä»¶ã«è²·ã†", "è‚©æ›¸ã ã‘ã§ç™ºè¨€ã®æ­£ã—ã•ã‚’åˆ¤æ–­ã™ã‚‹"]},

    {"title": "åŒèª¿åœ§åŠ›",
     "desc": "å‘¨å›²ã¨ã®æ‘©æ“¦ã‚’é¿ã‘ã‚‹ãŸã‚ã«ã€å†…å¿ƒã¨é•ã†é¸æŠã‚’ã—ã¦ã—ã¾ã†åŠ›ã€‚å°‘æ•°æ„è¦‹ã®ä¾¡å€¤ãŒåŸ‹ã‚‚ã‚Œã€å­¦ã³ã®æ©Ÿä¼šã‚’æ¸›ã‚‰ã—ã¾ã™ã€‚",
     "examples": ["ä¼šè­°ã§æœ¬éŸ³ã‚’è¨€ã‚ãšå¤šæ•°ã«åˆã‚ã›ã‚‹", "å‹äººã®æµè¡Œã«ç„¡ç†ã«ä¹—ã‚‹"]},

    {"title": "åˆ©ç”¨å¯èƒ½æ€§ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯",
     "desc": "æ€ã„å‡ºã—ã‚„ã™ã„å‡ºæ¥äº‹ã‚’â€œé »ç¹â€ã ã¨éŒ¯è¦šã™ã‚‹è¿‘é“æ€è€ƒã€‚å¼·ã„å°è±¡ã‚„æœ€è¿‘è¦‹ãŸæƒ…å ±ã«åˆ¤æ–­ãŒå¤§ããå¼•ã£å¼µã‚‰ã‚Œã¾ã™ã€‚",
     "examples": ["ãƒ‹ãƒ¥ãƒ¼ã‚¹ç›´å¾Œã«åŒäº‹æ•…ã®ç¢ºç‡ã‚’éå¤§è©•ä¾¡", "èº«è¿‘ãªä½“é¨“ã ã‘ã§å•†å“ã‚’é¸ã¶"]},

    {"title": "æ„Ÿæƒ…ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯",
     "desc": "æ€–ã•ãƒ»ä¸å®‰ãƒ»å¥½æ„ã¨ã„ã£ãŸæ„Ÿæƒ…ãŒã€ãã®ã¾ã¾åˆ¤æ–­ã«æ··å…¥ã™ã‚‹ç¾è±¡ã€‚è€ƒãˆã‚‹å‰ã«â€œæ„Ÿã˜â€ã§çµè«–ãŒå‡ºã¦ã—ã¾ã„ã¾ã™ã€‚",
     "examples": ["ä¸å®‰ã§é•·æœŸçš„ã«æãªä¿é™ºã‚’å¥‘ç´„", "å¥½æ„Ÿåº¦ã§å€™è£œã‚’æ—©ã€…ã«çµã‚‹"]},

    {"title": "ã‚´ãƒ¼ãƒ«ãƒ»ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ",
     "desc": "ç›®æ¨™ã«è¿‘ã¥ãã»ã©ã‚„ã‚‹æ°—ãŒå¢—ã™ç¾è±¡ã€‚é€²æ—ãŒå¯è¦–åŒ–ã•ã‚Œã‚‹ã¨ã€æœ€å¾Œã®ã²ã¨æŠ¼ã—ãŒå¼·ããªã‚Šå®Œäº†ç‡ãŒä¸ŠãŒã‚Šã¾ã™ã€‚",
     "examples": ["ãƒã‚¤ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ãŒåŸ‹ã¾ã‚‹ã¨æ€¥ã«é€šã†", "æ®‹ã‚Šã‚¿ã‚¹ã‚¯æ•°ãŒæ¸›ã‚‹ã¨åŠ é€Ÿã™ã‚‹"]},

    {"title": "ãƒŠãƒƒã‚¸åŠ¹æœ",
     "desc": "é¸æŠè‚¢ã®ä¸¦ã³ã‚„åˆæœŸè¨­å®šãªã©â€œãã£ã¨èƒŒä¸­ã‚’æŠ¼ã™â€å·¥å¤«ã§è¡Œå‹•ãŒå¤‰ã‚ã‚‹ã€‚ç¦æ­¢ã›ãšè‡ªç”±ã‚’æ®‹ã—ãŸã¾ã¾æ„æ€æ±ºå®šã‚’åŠ©ã‘ã¾ã™ã€‚",
     "examples": ["å¥åº·çš„ãªé£Ÿå“ã‚’å–ã‚Šã‚„ã™ã„ä½ç½®ã¸é…ç½®", "è‡ªå‹•ç©ç«‹ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ã™ã‚‹"]},

    {"title": "ãƒªãƒã‚¦ãƒ³ãƒ‰åŠ¹æœ",
     "desc": "å¼·ã„æˆ‘æ…¢ã‚„æ€¥ãªåˆ¶é™ã¯åå‹•ã‚’æ‹›ãã‚„ã™ã„ã€‚çŸ­æœŸã®æˆåŠŸã«æº€è¶³ã—ã€ã‹ãˆã£ã¦ä»¥å‰ã‚ˆã‚Šæˆ»ã£ã¦ã—ã¾ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚",
     "examples": ["å³ã—ã™ãã‚‹ãƒ€ã‚¤ã‚¨ãƒƒãƒˆå¾Œã«ãƒ‰ã‚«é£Ÿã„", "ç¯€ç´„ã®åå‹•ã§é«˜é¡ã®è¡å‹•è²·ã„"]},

    {"title": "ã‚¼ã‚¤ã‚¬ãƒ«ãƒ‹ã‚¯åŠ¹æœ",
     "desc": "æœªå®Œäº†ã®ã‚¿ã‚¹ã‚¯ã¯è¨˜æ†¶ã«æ®‹ã‚Šã‚„ã™ã„ç¾è±¡ã€‚æ•¢ãˆã¦â€œæœªå®Œã®çŠ¶æ…‹â€ã‚’ä½œã‚‹ã¨ã€æ¬¡ã«å–ã‚Šã‹ã‹ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒé«˜ã¾ã‚Šã¾ã™ã€‚",
     "examples": ["å‹‰å¼·ã‚’ä¸­é€”ã®ç« ã§æ­¢ã‚ç¿Œæ—¥ã‚¹ãƒƒã¨å†é–‹", "æ›¸ãã‹ã‘ã®ä¸‹æ›¸ãã§ä½œæ¥­ã‚’å†èµ·å‹•ã—ã‚„ã™ã„"]},

    {"title": "å¾ŒçŸ¥æµãƒã‚¤ã‚¢ã‚¹",
     "desc": "çµæœã‚’çŸ¥ã£ãŸå¾Œã§â€œæœ€åˆã‹ã‚‰åˆ†ã‹ã£ã¦ã„ãŸâ€ã¨æ„Ÿã˜ã‚‹éŒ¯è¦šã€‚éå»ã®åˆ¤æ–­ã‚’éåº¦ã«æ‰¹åˆ¤ã—ã€å­¦ã³æ–¹ã‚’èª¤ã‚‰ã›ã¾ã™ã€‚",
     "examples": ["æ ªä¾¡ä¸‹è½å¾Œã«ã€äºˆæƒ³ã—ã¦ãŸã€ã¨è¨€ã†", "è©¦åˆçµæœã‚’è¦‹ã¦æˆ¦è¡“ã‚’ç°¡å˜ã«è©•ä¾¡ã™ã‚‹"]},

    {"title": "æ‰€æœ‰åŠ¹æœ",
     "desc": "è‡ªåˆ†ãŒæ‰€æœ‰ã™ã‚‹ã¨åŒã˜ç‰©ã§ã‚‚ä¾¡å€¤ãŒä¸ŠãŒã£ã¦è¦‹ãˆã‚‹ç¾è±¡ã€‚å£²å€¤ã¨è²·å€¤ã®ã‚®ãƒ£ãƒƒãƒ—ãŒåºƒãŒã‚Šã€æ‰‹æ”¾ã—ã¥ã‚‰ããªã‚Šã¾ã™ã€‚",
     "examples": ["è‡ªä½œPCã‚’ç›¸å ´ã‚ˆã‚Šé«˜ãè¦‹ç©ã‚‚ã‚‹", "ã‚°ãƒƒã‚ºã‚’æ‰‹æ”¾ã›ãªã„"]},

    {"title": "éä¿¡ãƒã‚¤ã‚¢ã‚¹",
     "desc": "è‡ªåˆ†ã®èƒ½åŠ›ã‚„äºˆæ¸¬ã®æ­£ç¢ºã•ã‚’éå¤§è©•ä¾¡ã™ã‚‹å‚¾å‘ã€‚ãƒªã‚¹ã‚¯ã‚’è»½è¦–ã—ã€æ ¹æ‹ ã®è–„ã„æŒ‘æˆ¦ã§å¤±æ•—ç¢ºç‡ã‚’é«˜ã‚ã¾ã™ã€‚",
     "examples": ["ç›¸å ´ã®å¤©äº•åº•ã‚’å½“ã¦ã‚‰ã‚Œã‚‹ã¨æ€ã†", "æº–å‚™ä¸è¶³ã§ã‚‚ãƒ—ãƒ¬ã‚¼ãƒ³ã¯é€šã‚‹ã¨ä¿¡ã˜ã‚‹"]},

    {"title": "å°æ•°ã®æ³•å‰‡",
     "desc": "å°‘æ•°ã®ã‚µãƒ³ãƒ—ãƒ«ã‹ã‚‰å…¨ä½“ã‚’å®‰æ˜“ã«æ¨æ¸¬ã—ã¦ã—ã¾ã†èª¤ã‚Šã€‚å¶ç„¶ã®åã‚Šã‚’â€œå‚¾å‘â€ã ã¨å‹˜é•ã„ã—ãŒã¡ã§ã™ã€‚",
     "examples": ["ãƒ¬ãƒ“ãƒ¥ãƒ¼æ•°3ä»¶ã§å“è³ªã‚’æ–­å®š", "çŸ­æœŸé–“ã®ãƒ‡ãƒ¼ã‚¿ã§é•·æœŸã®çµè«–ã‚’å‡ºã™"]},

    {"title": "è‡ªå·±å¥‰ä»•ãƒã‚¤ã‚¢ã‚¹",
     "desc": "æˆåŠŸã¯å®ŸåŠ›ã€å¤±æ•—ã¯å¤–éƒ¨è¦å› ã¨è§£é‡ˆã—ã‚„ã™ã„å‚¾å‘ã€‚çœå¯Ÿã®è³ªãŒè½ã¡ã€æˆé•·ã®ãƒãƒ£ãƒ³ã‚¹ã‚’é€ƒã—ã¦ã—ã¾ã„ã¾ã™ã€‚",
     "examples": ["åˆæ ¼ã¯å®ŸåŠ›ã€ä¸åˆæ ¼ã¯é‹ã®ã›ã„", "å£²ä¸Šæ¸›ã‚’æ™¯æ°—ã ã‘ã®ã›ã„ã«ã™ã‚‹"]},

    {"title": "æ™‚é–“å‰²å¼•",
     "desc": "å°†æ¥ã‚ˆã‚Šä»Šã®åˆ©ç›Šã‚’éå¤§è©•ä¾¡ã™ã‚‹å¿ƒç†ã€‚é•·æœŸçš„ã«å¾—ã§ã‚‚ã€ç›®å…ˆã®å¿«æ¥½ã‚„æ‰‹é–“ã®å°‘ãªã•ã«æµã•ã‚Œã‚„ã™ããªã‚Šã¾ã™ã€‚",
     "examples": ["ç©ç«‹ã‚ˆã‚Šä»Šã®æ¶ˆè²»ã‚’å„ªå…ˆ", "å¾¹å¤œã—ã¦ã§ã‚‚ç›´è¿‘ã®å¨¯æ¥½ã‚’é¸ã¶"]},

    {"title": "æ­£å¸¸æ€§ãƒã‚¤ã‚¢ã‚¹",
     "desc": "éƒ½åˆã®æ‚ªã„æƒ…å ±ã‚’éå°è©•ä¾¡ã—ã€æ—¥å¸¸é€šã‚Šã ã¨è¦‹ãªã™å¿ƒç†ã€‚ãƒªã‚¹ã‚¯å¯¾å¿œãŒé…ã‚Œã€è¢«å®³ãŒæ‹¡å¤§ã™ã‚‹æã‚ŒãŒã‚ã‚Šã¾ã™ã€‚",
     "examples": ["é¿é›£å‹§å‘Šã§ã‚‚æ§˜å­è¦‹ã‚’ç¶šã‘ã‚‹", "ç•°å¸¸å€¤ã‚’è¨ˆæ¸¬ãƒŸã‚¹ã ã¨ç‰‡ä»˜ã‘ã‚‹"]},

    {"title": "ãƒ€ãƒ‹ãƒ³ã‚°ï¼ã‚¯ãƒ«ãƒ¼ã‚¬ãƒ¼åŠ¹æœ",
     "desc": "çŸ¥è­˜ãŒæµ…ã„ã»ã©è‡ªä¿¡ãŒé«˜ãã€ä¸€å®šä»¥ä¸Šã§è‡ªä¿¡ãŒä¸‹ãŒã‚‹ç¾è±¡ã€‚å­¦ã³å§‹ã‚ã®â€œåˆ†ã‹ã£ãŸæ°—â€ã«è¦æ³¨æ„ã§ã™ã€‚",
     "examples": ["å‹‰å¼·åˆæœŸã«å°‚é–€å®¶ã®ã‚ˆã†ã«èªã‚‹", "å°‘ã—ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šè‡ªå·±è©•ä¾¡ãŒæ€¥ä¸Šæ˜‡"]},
]




# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå¤‰ã‚ã£ãŸã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æƒé™¤
if st.session_state.get("tips_version") != VERSION:
    for k in ("tips_seen", "tips_clicks"):
        st.session_state.pop(k, None)
    try:
        st.cache_data.clear()
        st.cache_resource.clear()
    except Exception:
        pass
    st.session_state["tips_version"] = VERSION
    st.rerun()

# ã‚»ãƒƒã‚·ãƒ§ãƒ³æœ€å°é™ã®ã‚­ãƒ¼ï¼ˆãƒ—ãƒ¼ãƒ«ã¯æŒãŸãªã„ï¼‰
if "tips_seen" not in st.session_state:
    st.session_state["tips_seen"] = set()
if "tips_clicks" not in st.session_state:
    st.session_state["tips_clicks"] = 0

def pick_next_tip() -> dict:
    """æœªè¡¨ç¤ºã®ã‚‚ã®ã‹ã‚‰ 1 ä»¶ã€‚å°½ããŸã‚‰è‡ªå‹•ãƒªã‚»ãƒƒãƒˆã€‚"""
    n = len(TIPS)
    remaining = [i for i in range(n) if i not in st.session_state["tips_seen"]]
    if not remaining:
        st.session_state["tips_seen"] = set()
        remaining = list(range(n))
    # â€œä»Šæ—¥ + ã‚¯ãƒªãƒƒã‚¯å›æ•°â€ ã‚’ç¨®ã«ã—ã¦æ¯å›å¤‰ã‚ã‚‹ãŒæ—¥å†…ã¯å†ç¾æ€§ã‚ã‚Š
    seed = f"{datetime.date.today().isoformat()}-{st.session_state['tips_clicks']}"
    rng = random.Random(seed)
    idx = rng.choice(remaining)
    st.session_state["tips_seen"].add(idx)
    return TIPS[idx]

with st.expander("ãŠã¾ã‘ï¼šä»Šæ—¥ã®è±†çŸ¥è­˜", expanded=True):
    tip = pick_next_tip()
    body = f"**{tip['title']}**ï¼š{tip['desc']}\n\n**ä¾‹)**\n- {tip['examples'][0]}\n- {tip['examples'][1]}"
    st.markdown(body)
    if st.button("åˆ¥ã®è±†çŸ¥è­˜ã‚‚è¦‹ã‚‹", key="see_another_tip"):
        st.session_state["tips_clicks"] += 1
        st.rerun()

# å¤‰æ›´ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆæ‰‹ã§ä¸Šã’ã‚‹ï¼‰â€”â€” ç”»é¢ã«ã‚‚å‡ºã™
VERSION = "tips-2025-10-19-02"
st.caption(f"è±†çŸ¥è­˜ãƒ‡ãƒ¼ã‚¿ï¼š{VERSION}")

